---
title: 作业 4 解答
date: 2023-1-6 23:53:00
description: 概率分析和随机算法课后作业题解答
---

#### Problem 1 (教材习题 5-1)

**（概率计数）** 利用一个 $b$ 位的计数器，我们一般只能计数到 $2^b - 1$ 。而用 R.Morris 的 **概率计数法** ，我们可以计数到一个大得多的值，代价是精度有所损失。

对 $i = 0, 1, \cdots, 2^b - 1$ ，令计数器值 $i$ 表示 $n_i$ 的计数，其中 $n_i$ 构成了一个非负的递增序列。假设计数器初值为 $0$ ，表示计数 $n_0 = 0$ 。 INCREMENT 运算单元工作在一个计数器上，它以概率的方式包含值 $i$ 。如果 $i = 2^b - 1$ ，则该运算单元报告溢出错误；否则， INCREMENT 运算单元以概率 $1 / (n_{i+1} - n_i)$ 把计数器增加 $1$ ，以概率 $1 - 1/(n_{i+1} - n_i)$ 保持计数器不变。

对所有的 $i \ge 0$ ，若选择 $n_i = i$ ，此计数器就是一个普通的计数器。若选择 $n_i = 2^{i - 1} (i > 0)$ ，或者 $n_i = F_i$ （第 $i$ 个佩波那契数，参见[作业3](/solution3/hw3/)问题2），则会出现更多有趣的情形。

对于这个问题，假设 $n_{2^b - 1}$ 已经足够大，发生一个溢出错误的概率可以忽略。

1. 请说明在执行 $n$ 次 INCREMENT 操作后，计数器所表示的数期望值正好是 $n$ 。

2. 分析计数器表示的计数的方差依赖于 $n_i$ 序列。我们来看一个简单情形：对所有 $i \ge 0$ ， $n_i = 100i$ 。在执行了 $n$ 次 INCREMENT 操作后，请估计计数器所表示数的方差。

##### Solution



#### Problem 2 (教材习题 5-2)

**（查找一个无序数组）** 本题将分析三个算法，他们在一个包含 $n$ 个元素的无序数组 $A$ 中查找一个值 $x$ 。

考虑如下的随机策略：随机挑选 $A$ 中的一个下标 $i$ 。如果 $A[i] = x$ ，则终止；否则，继续挑选 $A$ 中一个新的随机下标。重复随机挑选下标，直到找到一个下标 $j$ ，使 $A[j] = x$ 或者直到我们已经检查过 $A$ 中的每一个元素。注意，我们每次都是从全部下标的集合中挑选，于是可能会不止一次地检查某个元素。

1. 请写出过程 RANDOM-SEARCH 的伪代码来实现上述策略。确保当 $A$ 中所有下标都挑选过时，你的算法应停止。

2. 假定恰好有一个下标 $i$ 使得 $A[i] = x$ 。在我们找到 $x$ 和 RANDOM-SEARCH 结束之前，必须挑选 $A$ 下标的数目期望是多少？

3. 假设有 $k \ge 1$ 个下标 $i$ 使得 $A[i] = x$ ，推广你对第2问的解答。在找到 $x$ 或 RANDOM-SEARCH 结束之前，必须挑选 $A$ 下标的数目期望是多少？你的答案应该是 $n$ 和 $k$ 的函数。

4. 假设没有下标 $i$ 使得 $A[i] = x$ 。在检查完 $A$ 的所有元素或 RANDOM-SEARCH 结束之前，我们必须挑选的 $A$ 的下标的数目期望是多少？

现在考虑一个确定性的线性查找算法，我们称之为 DETERMINSTIC-SEARCH 。具体地说，这个算法在 $A$ 中顺序查找 $x$ ，考虑 $A[1], A[2], A[3], \cdots, A[n]$ ，直到找到 $A[i] = x$ ，或者到达数组的末尾。假设输入数组的所有排列都是等可能的。

5. 假设恰好有一个下标 $i$ 使得 $A[i] = x$ 。 DETERMINSTIC-SEARCH 平均情形的运行时间是多少？ DETERMINSTIC-SEARCH 最坏情况的运行时间又是多少？

6. 假设有 $k \ge 1$ 个下标 $i$ 使得 $A[i] = x$ ，推广你对第5问的解答。 DETERMINSTIC-SEARCH 平均情形的运行时间是多少？ DETERMINSTIC-SEARCH 最坏情形的运行时间又是多少？你的答案应该是 $n$ 与 $k$ 的函数。

7. 假设没有下标 $i$ 使得 $A[i] = x$ 。 DETERMINSTIC-SEARCH 平均情形的运行时间是多少？ DETERMINSTIC-SEARCH 最坏情形的运行时间又是多少？

最后，考虑一个随机算法 SCRAMBLE-SEARCH ，它先将输入数组随机变换排列，然后在排列变换后的数组上，运行上面的确定性线性查找算法。

8. 设 $k$ 是满足 $A[i] = x$ 的下标的数目，请给出在 $k = 0$ 和 $k = 1$ 情况下，算法 SCRAMBLE-SEARCH 最坏情况的运行时间和运行时间期望。推广你的解答以处理 $k \ge 1$ 的情况。

9. 你将会使用 3 种查找算法中的哪一个？解释你的答案。

##### Solution

